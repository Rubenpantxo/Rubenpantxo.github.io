<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Rubenpantxo.com</title>
  <style>
    /* === ESTILOS GENERALES === */
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:"Courier New",monospace;background:#f8f8f8;min-height:100vh;padding:40px 20px;background-image:linear-gradient(rgba(100,149,237,.1) 1px,transparent 1px),linear-gradient(90deg,rgba(100,149,237,.1) 1px,transparent 1px);background-size:20px 20px}
    .container{max-width:820px;margin:0 auto;background:#fff;padding:60px 40px;border-radius:10px;box-shadow:0 0 20px rgba(0,0,0,.1);position:relative}
    .container:before{content:"";position:absolute;left:60px;top:0;bottom:0;width:2px;background:#ff6b6b}
    h1.title{color:#1e3a8a;font-size:2.5em;text-align:center;margin-bottom:50px;font-weight:bold;text-shadow:1px 1px 2px rgba(30,58,138,.3)}
    .navigation{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:20px;margin-bottom:40px}
    .nav-button{background:linear-gradient(135deg,#3b82f6,#1d4ed8);color:#fff;border:none;padding:20px;border-radius:15px;font-size:1.1em;cursor:pointer;transition:.3s;box-shadow:0 4px 15px rgba(59,130,246,.3)}
    .nav-button:hover{transform:translateY(-5px);box-shadow:0 8px 25px rgba(59,130,246,.4);background:linear-gradient(135deg,#2563eb,#1e40af)}
    .content-section{display:none;margin-top:40px;padding:30px;background:#f8fafc;border-radius:10px;border-left:4px solid #3b82f6;color:#1e3a8a;line-height:1.6}
    .content-section.active{display:block;animation:fadeIn .5s ease-in}
    @keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
    .section-title{color:#1e3a8a;font-size:1.8em;margin-bottom:20px;border-bottom:2px solid #3b82f6;padding-bottom:10px}
    /* === JUEGO === */
    #gameContainer{display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:#2d5016;z-index:1000}
    #gameCanvas{display:block;margin:0 auto;background:#8B4513}
    #gameUI{position:absolute;top:20px;left:20px;color:#fff;font-family:"Courier New",monospace;font-size:18px}
    #backButton{position:absolute;top:20px;right:20px;background:#ff4444;color:#fff;border:none;padding:10px 20px;border-radius:5px;cursor:pointer}
    #llenoMsg{position:absolute;top:60px;left:20px;color:#ff0;font-weight:bold;display:none;text-shadow:1px 1px 2px #000}
    .overlay{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;color:#fff;background:rgba(0,0,0,.6);padding:40px;border-radius:10px}
    @media(max-width:768px){.container{padding:40px 20px}.navigation{grid-template-columns:1fr}h1.title{font-size:2em}}
  </style>
</head>
<body>
  <div class="container">
    <!-- T√≠tulo principal del sitio -->
    <h1 class="title">Rubenpantxo.com</h1>

    <!-- Navegaci√≥n principal -->
    <div class="navigation">
      <button class="nav-button" onclick="showSection('contacto')">Contacto</button>
      <button class="nav-button" onclick="showSection('articulos')">Art√≠culos</button>
      <button class="nav-button" onclick="showSection('support')">Support</button>
      <button class="nav-button" onclick="showSection('play')">Jugar</button>
    </div>

    <!-- CONTACTO -->
    <div id="contacto" class="content-section active">
      <h2 class="section-title">Contacto</h2>
      <p><strong>Instagram:</strong> <a href="https://instagram.com/rubenpantxo" target="_blank">@rubenpantxo</a></p>
      <p><strong>Email:</strong> <a href="mailto:rubenpantxo@gmail.com">rubenpantxo@gmail.com</a></p>
    </div>

    <!-- ART√çCULOS -->
    <div id="articulos" class="content-section">
      <h2 class="section-title">Art√≠culos</h2>
      <p>Pr√≥ximamente‚Ä¶</p>
    </div>

    <!-- SUPPORT -->
    <div id="support" class="content-section">
      <h2 class="section-title">Support</h2>
      <p>Pr√≥ximamente‚Ä¶</p>
    </div>

    <!-- PLAY -->
    <div id="play" class="content-section">
      <h2 class="section-title">Jugar</h2>
      <h3 style="margin:10px 0 25px 0;color:#1e3a8a">Coge Capotas</h3>
      <button class="nav-button" onclick="startGame()">üéÆ Start</button>
    </div>
  </div>

  <!-- GAME FULL SCREEN -->
  <div id="gameContainer">
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <div id="gameUI">
      <div id="timer">Tiempo: 00:00</div>
      <div id="artichokes">Alcachofas: 0/5</div>
      <div id="total">Total recogidas: 0</div>
    </div>
    <div id="llenoMsg">¬°LLENO! Ve al tractor.</div>
    <button id="backButton" onclick="exitGame()">‚Üê Volver</button>
    <div id="gameOver" class="overlay" style="display:none">
      <h2>¬°Campo limpio!</h2>
      <p id="finalTime"></p>
      <button class="nav-button" onclick="exitGame()">Men√∫</button>
    </div>
  </div>

  <script>
    // === UTILIDADES Y NAVEGACI√ìN ===
    function showSection(id){
      // oculta todas
      document.querySelectorAll('.content-section').forEach(s=>s.classList.remove('active'));
      // muestra la elegida
      const target = document.getElementById(id);
      if(target) target.classList.add('active');
    }

    // === CONFIGURACI√ìN DEL JUEGO ===
    const MAX_CARRIED = 5;
    const FIELD_COLOR = '#8B4513';

    // Sprites (aseg√∫rate de que existan en la ruta dada)
    const playerImg    = new Image(); playerImg.src    = '2_Agricul.png';
    const tractorImg   = new Image(); tractorImg.src   = 'Tratorüöú.png';
    const artichokeImg = new Image(); artichokeImg.src = 'Alcachofa.png';

    const game = {
      canvas: document.getElementById('gameCanvas'),
      ctx:    null,
      keys:   {},
      artichokes: [],
      totalArtichokes: 50,
      carried:   0,
      collected: 0,
      player: {},
      tractor: {},
      startTime: 0,
      running: false,
    };

    // --- FUNCIONES AUXILIARES ---
    const clamp   = (v,min,max)=>Math.max(min,Math.min(max,v));
    const collide = (a,b)=>a.x < b.x + b.w && a.x + a.w > b.x && a.y < b.y + b.h && a.y + a.h > b.y;

    // --- FLUJO DE JUEGO ---
    function startGame(){
      document.getElementById('gameContainer').style.display='block';
      document.getElementById('gameOver').style.display='none';

      if(!game.ctx) game.ctx = game.canvas.getContext('2d');
      game.running   = true;
      game.carried   = 0;
      game.collected = 0;
      game.startTime = performance.now();

      game.player  = {x:game.canvas.width/2, y:game.canvas.height-120, w:48, h:48, speed:4};
      game.tractor = {x:game.canvas.width/2-64, y:40, w:128, h:96};

      // Generar alcachofas
      game.artichokes = [];
      for(let i=0;i<game.totalArtichokes;i++){
        game.artichokes.push({x:Math.random()*(game.canvas.width-40)+20,
                              y:Math.random()*(game.canvas.height-240)+140,
                              w:32,h:32,taken:false});
      }
      resizeCanvas();
      requestAnimationFrame(loop);
    }

    function exitGame(){
      game.running=false;
      document.getElementById('gameContainer').style.display='none';
    }

    // --- LOOP PRINCIPAL ---
    function loop(){ if(!game.running) return; update(); render(); requestAnimationFrame(loop); }

    function update(){
      // Movimiento jugador
      if(game.keys['ArrowLeft'])  game.player.x -= game.player.speed;
      if(game.keys['ArrowRight']) game.player.x += game.player.speed;
      if(game.keys['ArrowUp'])    game.player.y -= game.player.speed;
      if(game.keys['ArrowDown'])  game.player.y += game.player.speed;

      game.player.x = clamp(game.player.x,0,game.canvas.width  - game.player.w);
      game.player.y = clamp(game.player.y,0,game.canvas.height - game.player.h);

      // Recolectar alcachofas
      if(game.carried < MAX_CARRIED){
        game.artichokes.forEach(a=>{
          if(!a.taken && collide({...game.player,w:game.player.w,h:game.player.h}, a)){
            a.taken = true;
            game.carried++;
            game.collected++;
          }
        });
      }

      // Aviso de mochila llena
      document.getElementById('llenoMsg').style.display = (game.carried>=MAX_CARRIED) ? 'block' : 'none';

      // Descargar en tractor
      if(game.carried>0 && collide({...game.player,w:game.player.w,h:game.player.h}, game.tractor)){
        game.carried = 0;
      }

      // Fin de partida
      if(game.collected >= game.totalArtichokes && game.carried===0){
        game.running = false;
        const tiempo = ((performance.now()-game.startTime)/1000).toFixed(1);
        document.getElementById('finalTime').textContent = `Tiempo total: ${tiempo} s`;
        document.getElementById('gameOver').style.display='block';
      }

      // UI
      const elapsed = Math.floor((performance.now()-game.startTime)/1000);
      document.getElementById('timer').textContent      = `Tiempo: ${(elapsed/60>>0).toString().padStart(2,'0')}:${(elapsed%60).toString().padStart(2,'0')}`;
      document.getElementById('artichokes').textContent = `Alcachofas: ${game.carried}/${MAX_CARRIED}`;
      document.getElementById('total').textContent      = `Total recogidas: ${game.collected}`;
    }

    function render(){
      const ctx = game.ctx;
      ctx.fillStyle = FIELD_COLOR;
      ctx.fillRect(0,0,game.canvas.width,game.canvas.height);

      // Tractor
      if(tractorImg.complete) ctx.drawImage(tractorImg, game.tractor.x, game.tractor.y, game.tractor.w, game.tractor.h);
      else { ctx.fillStyle='#006400'; ctx.fillRect(game.tractor.x, game.tractor.y, game.tractor.w, game.tractor.h); }

      // Alcachofas
      game.artichokes.forEach(a=>{
        if(!a.taken){
          if(artichokeImg.complete) ctx.drawImage(artichokeImg, a.x, a.y, a.w, a.h);
          else { ctx.fillStyle='#228B22'; ctx.fillRect(a.x,a.y,a.w,a.h); }
        }
      });

      // Jugador
      if(playerImg.complete) ctx.drawImage(playerImg, game.player.x, game.player.y, game.player.w, game.player.h);
      else { ctx.fillStyle='#00f'; ctx.fillRect(game.player.x, game.player.y, game.player.w, game.player.h);
    }

    // ===== FIN RENDER =====
    }

    // --- TECLAS Y RESIZE ---
    window.addEventListener('keydown', e=>game.keys[e.key] = true);
    window.addEventListener('keyup',   e=>game.keys[e.key] = false);

    function resizeCanvas(){ game.canvas.width=window.innerWidth; game.canvas.height=window.innerHeight; }
    window.addEventListener('resize', resizeCanvas);
  </script>
</body>
</html>
